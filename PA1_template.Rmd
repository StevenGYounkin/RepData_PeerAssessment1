---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

load data in unzipped activity.csv file
```{r}
data <- read.csv("activity.csv")
print(data[1:1200,])
```

## What is mean total number of steps taken per day?

Calculate total steps per day ignoring intervals with missing data (na) and plot histogram
```{r}
s1 <- split(data, data$date)
Steps_Per_Day <- sapply(s1, function(x) sum(x[, "steps"], na.rm=T))
hist(Steps_Per_Day)
str(Steps_Per_Day)
print(names(Steps_Per_Day))
a<-c(Steps_Per_Day)
str(a)
```

Calculate and display mean total steps per day
```{r}
print(mean(Steps_Per_Day))
```

Calculate and display median total steps per day
```{r}
print(median(Steps_Per_Day))
```

## What is the average daily activity pattern?
Calculate and plot Mean_Steps_Per_Interval
```{r}
s2 <- split(data, data$interval)
Mean_Steps_Per_Interval <- sapply(s2, function(x) mean(x[, "steps"], na.rm=T))
Interval <- as.numeric(names(Mean_Steps_Per_Interval))
DataForPlot <- data.frame(Interval, Mean_Steps_Per_Interval)
str(DataForPlot)
print(DataForPlot)
plot(DataForPlot,ylab="Mean Steps Per Interval")
```

Determine the interval which, on average across all days in the dataset, contains the maximal number of steps. Display the interval and then the average number of steps in that interval.
```{r}
sorted <- sort(Mean_Steps_Per_Interval, decreasing=T)
print(sorted[1])
```
The maximum mean steps per interval occurred in interval 835 and was 206.1698 steps.

## Imputing missing values

Determine and display the total number of intervals where data on steps is missing
```{r}
y <- sum(is.na(data$steps))
print(y)
```

Fill in all missing values for steps with the average number of steps in that interval across all days
```{r}
#Make sure that the length of Mean_Steps_Per_Interval and data$steps are the same
y <- length(Mean_Steps_Per_Interval)
x <- length(data$steps)
print(y)
print(x)
z<-(x/y)
ReplacementValues <- vector()
for(i in 1:z){
ReplacementValues <- c(ReplacementValues, Mean_Steps_Per_Interval)       
}
print(head(ReplacementValues))
print(tail(ReplacementValues))
filleddata <- data
for(i in 1:x){
if(is.na(filleddata$steps[i]))
        filleddata$steps[i] <- ReplacementValues[i]
}
n <- sum(is.na(filleddata$steps))
print(n)
print(length(filleddata$steps))
```

Calculate total steps per day after filling in missing data (na) and plot histogram
```{r}
s1 <- split(filleddata, filleddata$date)
Filled_Steps_Per_Day <- sapply(s1, function(x) sum(x[, "steps"], na.rm=T))
hist(Filled_Steps_Per_Day)
```

Calculate and display mean total steps per day
```{r}
print(mean(Filled_Steps_Per_Day))
```

Calculate and display median total steps per day
```{r}
print(median(Filled_Steps_Per_Day))
```




## Are there differences in activity patterns between weekdays and weekends?
